import{S as H,i as Y,s as z,a3 as A,w as D,k as j,e as w,t as F,x as I,m as E,c as T,a as G,h as J,d as g,b as S,y as C,g as M,I as y,j as K,a5 as L,a6 as Q,a7 as R,q as O,o as P,B as N,Y as U,r as W}from"../../chunks/index-d77dc8df.js";import{s as b}from"../../chunks/api-22161ac7.js";import{N as X}from"../../chunks/Nav-d48a6773.js";import{M as Z}from"../../chunks/Meta-3a496eb2.js";import{p as V}from"../../chunks/tags-d87340e0.js";import{b as x}from"../../chunks/formatters-45a0f877.js";import"../../chunks/axios-9833b136.js";import"../../chunks/index-68131452.js";import"../../chunks/stores-85cb9109.js";function ee(s){let i,r,n,f,u=s[0]("pages.moderation")+"",o,p,e,a,d,_;i=new Z({props:{title:s[0]("pages.moderation"),noindex:!0}}),a=new X({props:{links:[{label:s[0]("pages.all"),href:""},{label:s[0]("pages.reports"),href:"report"},...V.map(s[4])],query:"type"}});const c=s[3].default,m=A(c,s,s[2],null);return{c(){D(i.$$.fragment),r=j(),n=w("div"),f=w("h1"),o=F(u),p=j(),e=w("div"),D(a.$$.fragment),d=j(),m&&m.c(),this.h()},l(t){I(i.$$.fragment,t),r=E(t),n=T(t,"DIV",{class:!0});var l=G(n);f=T(l,"H1",{});var h=G(f);o=J(h,u),h.forEach(g),p=E(l),e=T(l,"DIV",{class:!0});var v=G(e);I(a.$$.fragment,v),v.forEach(g),d=E(l),m&&m.l(l),l.forEach(g),this.h()},h(){S(e,"class","card"),S(n,"class","single-layout")},m(t,l){C(i,t,l),M(t,r,l),M(t,n,l),y(n,f),y(f,o),y(n,p),y(n,e),C(a,e,null),y(n,d),m&&m.m(n,null),_=!0},p(t,[l]){const h={};l&1&&(h.title=t[0]("pages.moderation")),i.$set(h),(!_||l&1)&&u!==(u=t[0]("pages.moderation")+"")&&K(o,u);const v={};l&1&&(v.links=[{label:t[0]("pages.all"),href:""},{label:t[0]("pages.reports"),href:"report"},...V.map(t[4])]),a.$set(v),m&&m.p&&(!_||l&4)&&L(m,c,t,t[2],_?R(c,t[2],l,null):Q(t[2]),null)},i(t){_||(O(i.$$.fragment,t),O(a.$$.fragment,t),O(m,t),_=!0)},o(t){P(i.$$.fragment,t),P(a.$$.fragment,t),P(m,t),_=!1},d(t){N(i,t),t&&g(r),t&&g(n),N(a),m&&m.d(t)}}}function $(){return $=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},$.apply(this,arguments)}function k(s,i,r,n,f,u,o){try{var p=s[u](o),e=p.value}catch(a){r(a);return}p.done?i(e):Promise.resolve(e).then(n,f)}function B(s){return function(){var i=this,r=arguments;return new Promise(function(n,f){var u=s.apply(i,r);function o(e){k(u,n,f,o,p,"next",e)}function p(e){k(u,n,f,o,p,"throw",e)}o(void 0)})}}function fe(s){return q.apply(this,arguments)}function q(){return q=B(function*(s){var{params:i,fetch:r,session:n,stuff:f}=s;try{var[u,o]=yield Promise.all([(yield b("GET","moderation/projects",null,{fetch:r})).map(e=>$({},e,{moderation_type:e.project_type})),(yield b("GET","report",null,{fetch:r})).map(e=>$({},e,{moderation_type:"report"}))]);o=yield Promise.all(o.map(function(){var e=B(function*(a){try{var d;a.item_id=(d=a.item_id)!=null&&d.replace?a.item_id.replace(/"/g,""):a.item_id;var _="";if(a.item_type==="user")_="/user/"+a.item_id;else if(a.item_type==="project"){var c=yield b("GET","project/"+a.item_id);a.item_id=c.slug||a.item_id,_="/"+c.project_type+"/"+a.item_id}else if(a.item_type==="version"){console.log("version/"+a.item_id);var m=yield b("GET","version/"+a.item_id),t=yield b("GET","project/"+m.project_id);a.item_id=m.version_number||a.item_id,_="/"+t.project_type+"/"+(t.slug||t.id)+"/version/"+a.item_id}return $({},a,{moderation_type:"report",url:_})}catch{}});return function(a){return e.apply(this,arguments)}}()));var p=[...u,...o].sort((e,a)=>new Date(e.published||e.created).valueOf()-new Date(a.published||a.created).valueOf());return{props:{items:p}}}catch{return{status:404,error:new Error("The moderation queue could not be received.")}}}),q.apply(this,arguments)}function te(s,i,r){let n;U(s,x,e=>r(0,n=e));let{$$slots:f={},$$scope:u}=i,{items:o}=i;W("items",o);const p=e=>({label:n(`project.types.${e}.plural`),href:e});return s.$$set=e=>{"items"in e&&r(1,o=e.items),"$$scope"in e&&r(2,u=e.$$scope)},[n,o,u,f,p]}class pe extends H{constructor(i){super(),Y(this,i,te,ee,z,{items:1})}}export{pe as default,fe as load};
