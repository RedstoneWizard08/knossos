import{S as se,i as ue,s as fe,e as S,w as P,c as T,a as V,x as D,d as b,b as w,g as y,y as M,E as X,q as g,o as k,B as j,k as I,m as E,N as Z,I as U,p as C,ab as ce,Y as q,n as G,ag as _e,Z as A,t as z,h as F,j as J,M as K,O as Q,P as W}from"../../../chunks/index-d77dc8df.js";import{B as L}from"../../../chunks/Button-e3650c0e.js";import{I as x}from"../../../chunks/Input-3093cfe1.js";import{M as pe}from"../../../chunks/Meta-3a496eb2.js";import{s as R}from"../../../chunks/api-22161ac7.js";import{p as ee}from"../../../chunks/app-8b88eb34.js";import{p as H,c as me,a as de}from"../../../chunks/_store-c7f9d3ff.js";import{C as ge}from"../../../chunks/check-aff0c417.js";import{P as he}from"../../../chunks/pencil-d3afbb94.js";import{P as be}from"../../../chunks/plus-f499d303.js";import{T as $e}from"../../../chunks/trash-86c5620f.js";import{X as ke}from"../../../chunks/x-f4a5dec2.js";import{b as ye}from"../../../chunks/formatters-45a0f877.js";import"../../../chunks/axios-9833b136.js";import"../../../chunks/index-68131452.js";function te(i,t,r){const l=i.slice();return l[18]=t[r],l[19]=t,l[20]=r,l}function le(i){let t,r,l;return r=new L({props:{label:"Upload image",icon:be,color:"brand"}}),r.$on("click",i[6]),{c(){t=S("div"),P(r.$$.fragment),this.h()},l(o){t=T(o,"DIV",{class:!0});var s=V(t);D(r.$$.fragment,s),s.forEach(b),this.h()},h(){w(t,"class","button-group")},m(o,s){y(o,t,s),M(r,t,null),l=!0},p:X,i(o){l||(g(r.$$.fragment,o),l=!0)},o(o){k(r.$$.fragment,o),l=!1},d(o){o&&b(t),j(r)}}}function ve(i){let t,r=i[18].title+"",l,o,s,u=i[18].description+"",n;return{c(){t=S("h1"),l=z(r),o=I(),s=S("p"),n=z(u),this.h()},l(e){t=T(e,"H1",{class:!0});var p=V(t);l=F(p,r),p.forEach(b),o=E(e),s=T(e,"P",{class:!0});var d=V(s);n=F(d,u),d.forEach(b),this.h()},h(){w(t,"class","title"),w(s,"class","gallery__item__description svelte-1m25dut")},m(e,p){y(e,t,p),U(t,l),y(e,o,p),y(e,s,p),U(s,n)},p(e,p){p&2&&r!==(r=e[18].title+"")&&J(l,r),p&2&&u!==(u=e[18].description+"")&&J(n,u)},i:X,o:X,d(e){e&&b(t),e&&b(o),e&&b(s)}}}function we(i){let t,r,l,o,s,u;function n(m){i[9](m,i[18])}let e={type:"text",placeholder:"Enter title..."};i[0][i[18].url].title!==void 0&&(e.value=i[0][i[18].url].title),t=new x({props:e}),K.push(()=>Q(t,"value",n));function p(m){i[10](m,i[18])}let d={type:"textarea",placeholder:"Enter description..."};return i[0][i[18].url].description!==void 0&&(d.value=i[0][i[18].url].description),o=new x({props:d}),K.push(()=>Q(o,"value",p)),{c(){P(t.$$.fragment),l=I(),P(o.$$.fragment)},l(m){D(t.$$.fragment,m),l=E(m),D(o.$$.fragment,m)},m(m,a){M(t,m,a),y(m,l,a),M(o,m,a),u=!0},p(m,a){i=m;const f={};!r&&a&3&&(r=!0,f.value=i[0][i[18].url].title,W(()=>r=!1)),t.$set(f);const c={};!s&&a&3&&(s=!0,c.value=i[0][i[18].url].description,W(()=>s=!1)),o.$set(c)},i(m){u||(g(t.$$.fragment,m),g(o.$$.fragment,m),u=!0)},o(m){k(t.$$.fragment,m),k(o.$$.fragment,m),u=!1},d(m){j(t,m),m&&b(l),j(o,m)}}}function re(i){let t,r,l,o;const s=[Ee,Ie],u=[];function n(e,p){return e[0][e[18].url]?0:1}return r=n(i),l=u[r]=s[r](i),{c(){t=S("div"),l.c(),this.h()},l(e){t=T(e,"DIV",{class:!0});var p=V(t);l.l(p),p.forEach(b),this.h()},h(){w(t,"class","button-group svelte-1m25dut")},m(e,p){y(e,t,p),u[r].m(t,null),o=!0},p(e,p){let d=r;r=n(e),r===d?u[r].p(e,p):(G(),k(u[d],1,1,()=>{u[d]=null}),C(),l=u[r],l?l.p(e,p):(l=u[r]=s[r](e),l.c()),g(l,1),l.m(t,null))},i(e){o||(g(l),o=!0)},o(e){k(l),o=!1},d(e){e&&b(t),u[r].d()}}}function Ie(i){let t,r,l,o;function s(){return i[13](i[18])}t=new L({props:{label:"Edit",icon:he}}),t.$on("click",s);function u(){return i[14](i[18])}return l=new L({props:{label:"Delete",icon:$e}}),l.$on("click",u),{c(){P(t.$$.fragment),r=I(),P(l.$$.fragment)},l(n){D(t.$$.fragment,n),r=E(n),D(l.$$.fragment,n)},m(n,e){M(t,n,e),y(n,r,e),M(l,n,e),o=!0},p(n,e){i=n},i(n){o||(g(t.$$.fragment,n),g(l.$$.fragment,n),o=!0)},o(n){k(t.$$.fragment,n),k(l.$$.fragment,n),o=!1},d(n){j(t,n),n&&b(r),j(l,n)}}}function Ee(i){let t,r,l,o;function s(){return i[11](i[18])}t=new L({props:{label:"Save",icon:ge,color:"brand"}}),t.$on("click",s);function u(){return i[12](i[18])}return l=new L({props:{label:"Cancel",icon:ke}}),l.$on("click",u),{c(){P(t.$$.fragment),r=I(),P(l.$$.fragment)},l(n){D(t.$$.fragment,n),r=E(n),D(l.$$.fragment,n)},m(n,e){M(t,n,e),y(n,r,e),M(l,n,e),o=!0},p(n,e){i=n},i(n){o||(g(t.$$.fragment,n),g(l.$$.fragment,n),o=!0)},o(n){k(t.$$.fragment,n),k(l.$$.fragment,n),o=!1},d(n){j(t,n),n&&b(r),j(l,n)}}}function ne(i,t){let r,l,o,s,u,n,e,p,d;const m=[we,ve],a=[];function f($,h){return $[0][$[18].url]?0:1}u=f(t),n=a[u]=m[u](t);let c=t[4].data.editDetails&&re(t);return{key:i,first:null,c(){r=S("div"),l=S("img"),s=I(),n.c(),e=I(),c&&c.c(),p=I(),this.h()},l($){r=T($,"DIV",{class:!0});var h=V(r);l=T(h,"IMG",{class:!0,src:!0,alt:!0}),s=E(h),n.l(h),e=E(h),c&&c.l(h),p=E(h),h.forEach(b),this.h()},h(){w(l,"class","gallery__item__image svelte-1m25dut"),Z(l.src,o=t[18].url)||w(l,"src",o),w(l,"alt",""),w(r,"class","card gallery__item svelte-1m25dut"),this.first=r},m($,h){y($,r,h),U(r,l),U(r,s),a[u].m(r,null),U(r,e),c&&c.m(r,null),U(r,p),d=!0},p($,h){t=$,(!d||h&2&&!Z(l.src,o=t[18].url))&&w(l,"src",o);let B=u;u=f(t),u===B?a[u].p(t,h):(G(),k(a[B],1,1,()=>{a[B]=null}),C(),n=a[u],n?n.p(t,h):(n=a[u]=m[u](t),n.c()),g(n,1),n.m(r,e)),t[4].data.editDetails?c?(c.p(t,h),h&16&&g(c,1)):(c=re(t),c.c(),g(c,1),c.m(r,p)):c&&(G(),k(c,1,1,()=>{c=null}),C())},i($){d||(g(n),g(c),d=!0)},o($){k(n),k(c),d=!1},d($){$&&b(r),a[u].d(),c&&c.d()}}}function Pe(i){var m;let t,r,l,o,s=[],u=new Map,n;t=new pe({props:{title:i[1].title+" - "+i[2]("pages.gallery"),description:"View "+i[1].gallery.length+" images of the Minecraft "+i[1].project_type+" "+i[1].title+" on Modrinth.",color:i[3],image:(m=i[1])==null?void 0:m.icon_url}});let e=i[4].data.editDetails&&le(i),p=i[1].gallery.filter(i[8]);const d=a=>a[18].url;for(let a=0;a<p.length;a+=1){let f=te(i,p,a),c=d(f);u.set(c,s[a]=ne(c,f))}return{c(){P(t.$$.fragment),r=I(),e&&e.c(),l=I(),o=S("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){D(t.$$.fragment,a),r=E(a),e&&e.l(a),l=E(a),o=T(a,"DIV",{class:!0});var f=V(o);for(let c=0;c<s.length;c+=1)s[c].l(f);f.forEach(b),this.h()},h(){w(o,"class","gallery svelte-1m25dut")},m(a,f){M(t,a,f),y(a,r,f),e&&e.m(a,f),y(a,l,f),y(a,o,f);for(let c=0;c<s.length;c+=1)s[c].m(o,null);n=!0},p(a,[f]){var $;const c={};f&6&&(c.title=a[1].title+" - "+a[2]("pages.gallery")),f&2&&(c.description="View "+a[1].gallery.length+" images of the Minecraft "+a[1].project_type+" "+a[1].title+" on Modrinth."),f&8&&(c.color=a[3]),f&2&&(c.image=($=a[1])==null?void 0:$.icon_url),t.$set(c),a[4].data.editDetails?e?(e.p(a,f),f&16&&g(e,1)):(e=le(a),e.c(),g(e,1),e.m(l.parentNode,l)):e&&(G(),k(e,1,1,()=>{e=null}),C()),f&179&&(p=a[1].gallery.filter(a[8]),G(),s=ce(s,f,d,1,a,p,u,o,_e,ne,null,te),C())},i(a){if(!n){g(t.$$.fragment,a),g(e);for(let f=0;f<p.length;f+=1)g(s[f]);n=!0}},o(a){k(t.$$.fragment,a),k(e);for(let f=0;f<s.length;f+=1)k(s[f]);n=!1},d(a){j(t,a),a&&b(r),e&&e.d(a),a&&b(l),a&&b(o);for(let f=0;f<s.length;f+=1)s[f].d()}}}function ie(i,t,r,l,o,s,u){try{var n=i[s](u),e=n.value}catch(p){r(p);return}n.done?t(e):Promise.resolve(e).then(l,o)}function N(i){return function(){var t=this,r=arguments;return new Promise(function(l,o){var s=i.apply(t,r);function u(e){ie(s,l,o,u,n,"next",e)}function n(e){ie(s,l,o,u,n,"throw",e)}u(void 0)})}}function De(i,t,r){let l,o,s,u,n;q(i,H,_=>r(1,l=_)),q(i,ee,_=>r(17,o=_)),q(i,ye,_=>r(2,s=_)),q(i,me,_=>r(3,u=_)),q(i,de,_=>r(4,n=_));var e={};function p(_){return d.apply(this,arguments)}function d(){return d=N(function*(_){yield R("PATCH","project/"+l.id+"/gallery?"+new URLSearchParams({url:_.url,featured:"false",title:_.title||"\u200B",description:_.description||"\u200B"})),delete e[_.url],r(0,e)}),d.apply(this,arguments)}function m(){A(ee,o=[{title:"Upload gallery image",body:"",type:{creation:"galleryItem"},button:{click:function(){var _=N(function*(O){var{name:ae,body:oe,file:Y}=O;yield R("POST","project/"+l.id+"/gallery?"+new URLSearchParams({ext:Y.name.split(".").pop(),featured:"false",title:ae||"\u200B",description:oe||"\u200B"}),Y),A(H,l.gallery=(yield R("GET","project/"+l.id)).gallery,l)});function v(O){return _.apply(this,arguments)}return v}(),label:"Upload image"}},...o],o)}function a(_){return f.apply(this,arguments)}function f(){return f=N(function*(_){window.confirm("Are you sure you want to delete this gallery image?")&&(yield R("DELETE","project/"+l.id+"/gallery?"+new URLSearchParams({url:_.url})),A(H,l.gallery=l.gallery.filter(v=>v.url!==_.url),l))}),f.apply(this,arguments)}const c=(_,v)=>l.gallery.map(O=>O.url).indexOf(_.url)===v;function $(_,v){i.$$.not_equal(e[v.url].title,_)&&(e[v.url].title=_,r(0,e))}function h(_,v){i.$$.not_equal(e[v.url].description,_)&&(e[v.url].description=_,r(0,e))}return[e,l,s,u,n,p,m,a,c,$,h,_=>p(_),_=>{delete e[_.url],r(0,e)},_=>r(0,e[_.url]=_,e),_=>a(_)]}class Ze extends se{constructor(t){super(),ue(this,t,De,Pe,fe,{})}}export{Ze as default};
